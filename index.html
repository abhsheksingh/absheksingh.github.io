<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abhishek Singh</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
  </head>
  <body>
    <div>
      <button class="dtv-btn" data-category="Category1">Category 1</button>
      <button class="dtv-btn" data-category="Category2">Category 2</button>
    </div>
    <div id="tech-graph-container" style="width:100%; height:400px;">
      <svg class="d3-graph" width="100%" height="400"></svg>
    </div>

    <script>
      let categories = [
        {
          category: "Category1",
          technologies: [
            { name: "Tech1" },
            { name: "Tech2" },
          ],
        },
        {
          category: "Category2",
          technologies: [
            { name: "TechA" },
            { name: "TechB" },
          ],
        },
      ];

      // Function to draw a tree with animation
      function drawTree(categoryName) {
        const container = document.querySelector("#tech-graph-container");
        const width = container.clientWidth;
        const height = container.clientHeight;

        const svg = d3.select("svg.d3-graph");
        svg.selectAll("*").remove();

        const category = categories.find((c) => c.category === categoryName);
        const data = { name: category.category, children: category.technologies };
        const root = d3.hierarchy(data);

        const treeLayout = d3.tree().size([width, height - 100]);
        treeLayout(root);

        const nodes = root.descendants();
        const links = root.links();

        const g = svg.append("g").attr("transform", "translate(0, 50)");

        // Draw links with animation
        const link = g
          .selectAll(".link")
          .data(links)
          .join("path")
          .attr("class", "link")
          .attr("stroke", "#ccc")
          .attr("fill", "none")
          .attr("d", d3.linkVertical().x((d) => d.source.x).y((d) => d.source.y)) // Initial state
          .transition()
          .duration(1000)
          .attr("d", d3.linkVertical().x((d) => d.target.x).y((d) => d.target.y)); // Final state

        // Draw nodes
        const node = g
          .selectAll(".node")
          .data(nodes)
          .join("g")
          .attr("class", "node")
          .attr("transform", (d) =>
            d.parent
              ? `translate(${d.parent.x},${d.parent.y})`
              : `translate(${d.x},${d.y})`
          )
          .transition()
          .duration(1000)
          .attr("transform", (d) => `translate(${d.x},${d.y})`); // Animate new position

        node
          .append("circle")
          .attr("r", 0) // Initial state
          .transition()
          .duration(1000)
          .attr("r", 20) // Final state
          .style("fill", "white")
          .attr("stroke", "black");
      }

      // Event listener for button clicks
      document.querySelectorAll(".dtv-btn").forEach((button) => {
        button.addEventListener("click", (e) => {
          const categoryName = e.target.getAttribute("data-category");
          drawTree(categoryName);
        });
      });

      // Draw the initial tree
      drawTree(categories[0].category);
    </script>
  </body>
</html>